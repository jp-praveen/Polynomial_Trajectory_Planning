function [desired_state] = traj_line(t, ~)

% t_max = 4;
% t = max(0, min(t, t_max));
% t = t/t_max;
flag = 10;

if flag == 1
    tnodes = [0,1,3,5];
else
    tnodes = [0,3,6,9];
    
end
if t<=tnodes(2)
    if flag == 1
        C0x = [0,-0.659347478851710,155.123420908191];
        C0y = C0x;
        C0z = C0x;

        C1x = [0,4.61543235196196,-358.877693884473];
        C1y = C1x;
        C1z = C1x;

        C2x = [0,-13.8462970558858,349.646829180549];
        C2y = C2x;
        C2z = C2x;

        C3x = [0,23.0771617598097,-178.863463927098];
        C3y = C3x;
        C3z = C3x;

        C4x = [7.78517878429004,-15.2919829755197,52.0215589201161];
        C4y = C4x;
        C4z = C4x;

        C5x = [-9.06368375604442,4.78261329984141,-8.68009507928575];
        C5y = C5x;
        C5z = C5x;

        C6x = [3.89548091860669,-0.719951433355258,0.775905053214427];
        C6y = C6x;
        C6z = C6x;

        C7x = [-0.616975946852305,0.0423715319994012,-0.0288597292658219];
        C7y = C7x;
        C7z = C7x;
        
    else      

        C0x = [0,-2.50397456279890,318.004769475611];
        C0y = C0x;
        C0z = C0x;

        C1x = [0,5.84260731319758,-368.084260731619];
        C1y = C1x;
        C1z = C1x;

        C2x = [0,-5.84260731319764,181.120826709212];
        C2y = C2x;
        C2z = C2x;

        C3x = [0,3.24589295177648,-48.6883942766708];
        C3y = C3x;
        C3z = C3x;

        C4x = [0.130866160277944,-0.951098156980882,7.70461638109367];
        C4y = C4x;
        C4z = C4x;

        C5x = [-0.0669558447336359,0.149437018718129,-0.716134435089326];
        C5y = C5x;
        C5z = C5x;

        C6x = [0.0121363193258648,-0.0119073321687758,0.0361799708205272];
        C6y = C6x;
        C6z = C6x;

        C7x = [-0.000766925240418555,0.000378010545040520,-0.000766925240419076];
        C7y = C7x;
        C7z = C7x;
    end
    
    desired_state.pos(1,1) = C0x(1) + C1x(1)*t + C2x(1)*t^2 + C3x(1)*t^3 + C4x(1)*t^4 + C5x(1)*t^5 + C6x(1)*t^6 + C7x(1)*t^7;    
    desired_state.pos(2,1) = C0y(1) + C1y(1)*t + C2y(1)*t^2 + C3y(1)*t^3 + C4y(1)*t^4 + C5y(1)*t^5 + C6y(1)*t^6 + C7y(1)*t^7;
    desired_state.pos(3,1) = C0z(1) + C1z(1)*t + C2z(1)*t^2 + C3z(1)*t^3 + C4z(1)*t^4 + C5z(1)*t^5 + C6z(1)*t^6 + C7z(1)*t^7;
    desired_state.yaw(1,1) = C0x(1) + C1x(1)*t + C2x(1)*t^2 + C3x(1)*t^3 + C4x(1)*t^4 + C5x(1)*t^5 + C6x(1)*t^6 + C7x(1)*t^7;    

    desired_state.vel(1,1) = C1x(1) + C2x(1)*t + C3x(1)*t^2 + C4x(1)*t^3 + C5x(1)*t^4 + C6x(1)*t^5 + C7x(1)*t^6;
    desired_state.vel(2,1) = C1y(1) + C2y(1)*t + C3y(1)*t^2 + C4y(1)*t^3 + C5y(1)*t^4 + C6y(1)*t^5 + C7y(1)*t^6;
    desired_state.vel(3,1) = C1z(1) + C2z(1)*t + C3z(1)*t^2 + C4z(1)*t^3 + C5z(1)*t^4 + C6z(1)*t^5 + C7z(1)*t^6;
    desired_state.yawdot(1,1) = C1z(1) + C2z(1)*t + C3z(1)*t^2 + C4z(1)*t^3 + C5z(1)*t^4 + C6z(1)*t^5 + C7z(1)*t^6;
    
    desired_state.acc(1,1) = C2x(1) + C3x(1)*t + C4x(1)*t^2 + C5x(1)*t^3 + C6x(1)*t^4 + C7x(1)*t^5;
    desired_state.acc(2,1) = C2y(1) + C3y(1)*t + C4y(1)*t^2 + C5y(1)*t^3 + C6y(1)*t^4 + C7y(1)*t^5;
    desired_state.acc(3,1) = C2z(1) + C3z(1)*t + C4z(1)*t^2 + C5z(1)*t^3 + C6z(1)*t^4 + C7z(1)*t^5;
elseif t > tnodes(2) && t<= tnodes(3) 
    if flag == 1
        C0x = [0,-0.659347478851710,155.123420908191];
        C0y = C0x;
        C0z = C0x;

        C1x = [0,4.61543235196196,-358.877693884473];
        C1y = C1x;
        C1z = C1x;

        C2x = [0,-13.8462970558858,349.646829180549];
        C2y = C2x;
        C2z = C2x;

        C3x = [0,23.0771617598097,-178.863463927098];
        C3y = C3x;
        C3z = C3x;

        C4x = [7.78517878429004,-15.2919829755197,52.0215589201161];
        C4y = C4x;
        C4z = C4x;

        C5x = [-9.06368375604442,4.78261329984141,-8.68009507928575];
        C5y = C5x;
        C5z = C5x;

        C6x = [3.89548091860669,-0.719951433355258,0.775905053214427];
        C6y = C6x;
        C6z = C6x;

        C7x = [-0.616975946852305,0.0423715319994012,-0.0288597292658219];
        C7y = C7x;
        C7z = C7x;
        
    else      

        C0x = [0,-2.50397456279890,318.004769475611];
        C0y = C0x;
        C0z = C0x;

        C1x = [0,5.84260731319758,-368.084260731619];
        C1y = C1x;
        C1z = C1x;

        C2x = [0,-5.84260731319764,181.120826709212];
        C2y = C2x;
        C2z = C2x;

        C3x = [0,3.24589295177648,-48.6883942766708];
        C3y = C3x;
        C3z = C3x;

        C4x = [0.130866160277944,-0.951098156980882,7.70461638109367];
        C4y = C4x;
        C4z = C4x;

        C5x = [-0.0669558447336359,0.149437018718129,-0.716134435089326];
        C5y = C5x;
        C5z = C5x;

        C6x = [0.0121363193258648,-0.0119073321687758,0.0361799708205272];
        C6y = C6x;
        C6z = C6x;

        C7x = [-0.000766925240418555,0.000378010545040520,-0.000766925240419076];
        C7y = C7x;
        C7z = C7x;
    end
    desired_state.pos(1,1) = C0x(2) + C1x(2)*t + C2x(2)*t^2 + C3x(2)*t^3 + C4x(2)*t^4 + C5x(2)*t^5 + C6x(2)*t^6 + C7x(2)*t^7;    
    desired_state.pos(2,1) = C0y(2) + C1y(2)*t + C2y(2)*t^2 + C3y(2)*t^3 + C4y(2)*t^4 + C5y(2)*t^5 + C6y(2)*t^6 + C7y(2)*t^7;
    desired_state.pos(3,1) = C0z(2) + C1z(2)*t + C2z(2)*t^2 + C3z(2)*t^3 + C4z(2)*t^4 + C5z(2)*t^5 + C6z(2)*t^6 + C7z(2)*t^7;
    desired_state.yaw(1,1) = C0x(2) + C1x(2)*t + C2x(2)*t^2 + C3x(2)*t^3 + C4x(2)*t^4 + C5x(2)*t^5 + C6x(2)*t^6 + C7x(2)*t^7;    

    desired_state.vel(1,1) = C1x(2) + C2x(2)*t + C3x(2)*t^2 + C4x(2)*t^3 + C5x(2)*t^4 + C6x(2)*t^5 + C7x(2)*t^6;
    desired_state.vel(2,1) = C1y(2) + C2y(2)*t + C3y(2)*t^2 + C4y(2)*t^3 + C5y(2)*t^4 + C6y(2)*t^5 + C7y(2)*t^6;
    desired_state.vel(3,1) = C1z(2) + C2z(2)*t + C3z(2)*t^2 + C4z(2)*t^3 + C5z(2)*t^4 + C6z(2)*t^5 + C7z(2)*t^6;
    desired_state.yawdot(1,1) = C1z(2) + C2z(2)*t + C3z(2)*t^2 + C4z(2)*t^3 + C5z(2)*t^4 + C6z(2)*t^5 + C7z(2)*t^6;
    
    desired_state.acc(1,1) = C2x(2) + C3x(2)*t + C4x(2)*t^2 + C5x(2)*t^3 + C6x(2)*t^4 + C7x(2)*t^5;
    desired_state.acc(2,1) = C2y(2) + C3y(2)*t + C4y(2)*t^2 + C5y(2)*t^3 + C6y(2)*t^4 + C7y(2)*t^5;
    desired_state.acc(3,1) = C2z(2) + C3z(2)*t + C4z(2)*t^2 + C5z(2)*t^3 + C6z(2)*t^4 + C7z(2)*t^5;
    
else
    t = tnodes(3); 
    if flag == 1
        C0x = [0,-0.659347478851710,155.123420908191];
        C0y = C0x;
        C0z = C0x;

        C1x = [0,4.61543235196196,-358.877693884473];
        C1y = C1x;
        C1z = C1x;

        C2x = [0,-13.8462970558858,349.646829180549];
        C2y = C2x;
        C2z = C2x;

        C3x = [0,23.0771617598097,-178.863463927098];
        C3y = C3x;
        C3z = C3x;

        C4x = [7.78517878429004,-15.2919829755197,52.0215589201161];
        C4y = C4x;
        C4z = C4x;

        C5x = [-9.06368375604442,4.78261329984141,-8.68009507928575];
        C5y = C5x;
        C5z = C5x;

        C6x = [3.89548091860669,-0.719951433355258,0.775905053214427];
        C6y = C6x;
        C6z = C6x;

        C7x = [-0.616975946852305,0.0423715319994012,-0.0288597292658219];
        C7y = C7x;
        C7z = C7x;
        
    else      

        C0x = [0,-2.50397456279890,318.004769475611];
        C0y = C0x;
        C0z = C0x;

        C1x = [0,5.84260731319758,-368.084260731619];
        C1y = C1x;
        C1z = C1x;

        C2x = [0,-5.84260731319764,181.120826709212];
        C2y = C2x;
        C2z = C2x;

        C3x = [0,3.24589295177648,-48.6883942766708];
        C3y = C3x;
        C3z = C3x;

        C4x = [0.130866160277944,-0.951098156980882,7.70461638109367];
        C4y = C4x;
        C4z = C4x;

        C5x = [-0.0669558447336359,0.149437018718129,-0.716134435089326];
        C5y = C5x;
        C5z = C5x;

        C6x = [0.0121363193258648,-0.0119073321687758,0.0361799708205272];
        C6y = C6x;
        C6z = C6x;

        C7x = [-0.000766925240418555,0.000378010545040520,-0.000766925240419076];
        C7y = C7x;
        C7z = C7x;
    end
    desired_state.pos(1,1) = C0x(2) + C1x(2)*t + C2x(2)*t^2 + C3x(2)*t^3 + C4x(2)*t^4 + C5x(2)*t^5 + C6x(2)*t^6 + C7x(2)*t^7;    
    desired_state.pos(2,1) = C0y(2) + C1y(2)*t + C2y(2)*t^2 + C3y(2)*t^3 + C4y(2)*t^4 + C5y(2)*t^5 + C6y(2)*t^6 + C7y(2)*t^7;
    desired_state.pos(3,1) = C0z(2) + C1z(2)*t + C2z(2)*t^2 + C3z(2)*t^3 + C4z(2)*t^4 + C5z(2)*t^5 + C6z(2)*t^6 + C7z(2)*t^7;
    desired_state.yaw(1,1) = C0x(2) + C1x(2)*t + C2x(2)*t^2 + C3x(2)*t^3 + C4x(2)*t^4 + C5x(2)*t^5 + C6x(2)*t^6 + C7x(2)*t^7;    

    desired_state.vel(1,1) = C1x(2) + C2x(2)*t + C3x(2)*t^2 + C4x(2)*t^3 + C5x(2)*t^4 + C6x(2)*t^5 + C7x(2)*t^6;
    desired_state.vel(2,1) = C1y(2) + C2y(2)*t + C3y(2)*t^2 + C4y(2)*t^3 + C5y(2)*t^4 + C6y(2)*t^5 + C7y(2)*t^6;
    desired_state.vel(3,1) = C1z(2) + C2z(2)*t + C3z(2)*t^2 + C4z(2)*t^3 + C5z(2)*t^4 + C6z(2)*t^5 + C7z(2)*t^6;
    desired_state.yawdot(1,1) = C1z(2) + C2z(2)*t + C3z(2)*t^2 + C4z(2)*t^3 + C5z(2)*t^4 + C6z(2)*t^5 + C7z(2)*t^6;
    
    desired_state.acc(1,1) = C2x(2) + C3x(2)*t + C4x(2)*t^2 + C5x(2)*t^3 + C6x(2)*t^4 + C7x(2)*t^5;
    desired_state.acc(2,1) = C2y(2) + C3y(2)*t + C4y(2)*t^2 + C5y(2)*t^3 + C6y(2)*t^4 + C7y(2)*t^5;
    desired_state.acc(3,1) = C2z(2) + C3z(2)*t + C4z(2)*t^2 + C5z(2)*t^3 + C6z(2)*t^4 + C7z(2)*t^5;
    
end
% desired_state.yawdot(1,1) =0;
% desired_state.yaw(1,1) = 0;
% t_max = 4;
% t = max(0, min(t, t_max));
% t = t/t_max;
% 
% pos = 10*t.^3 - 15*t.^4 + 6*t.^5;
% vel = (30/t_max)*t.^2 - (60/t_max)*t.^3 + (30/t_max)*t.^4;
% acc = (60/t_max^2)*t - (180/t_max^2)*t.^2 + (120/t_max^2)*t.^3;
%     
% %output desired state
% desired_state.pos = [pos; pos; pos];
% desired_state.vel = [vel; vel; vel];
% desired_state.acc = [acc; acc; acc];
% desired_state.yaw = pos;
% desired_state.yawdot = vel;

end
